<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/platform/weave-self-managed" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">W&amp;B Weave Self-Managed | W&amp;B Weave</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://weave-docs.wandb.ai/img/logo-large-padded.png"><meta data-rh="true" name="twitter:image" content="https://weave-docs.wandb.ai/img/logo-large-padded.png"><meta data-rh="true" property="og:url" content="https://weave-docs.wandb.ai/guides/platform/weave-self-managed"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="W&amp;B Weave Self-Managed | W&amp;B Weave"><meta data-rh="true" name="description" content="Weave on self-managed infrastructure is currently in Private Preview."><meta data-rh="true" property="og:description" content="Weave on self-managed infrastructure is currently in Private Preview."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://weave-docs.wandb.ai/guides/platform/weave-self-managed"><link data-rh="true" rel="alternate" href="https://weave-docs.wandb.ai/guides/platform/weave-self-managed" hreflang="en"><link data-rh="true" rel="alternate" href="https://weave-docs.wandb.ai/guides/platform/weave-self-managed" hreflang="x-default"><link rel="preconnect" href="https://cdn.segment.io">
<script>!function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],e.factory=function(t){return function(){if(window.analytics.initialized)return window.analytics[t].apply(window.analytics,arguments);var a=Array.prototype.slice.call(arguments);return a.unshift(t),e.push(a),e}};for(var t=0;t<e.methods.length;t++){var a=e.methods[t];e[a]=e.factory(a)}e.load=function(t,a){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://wandb.ai/sa-docs.min.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i),e._loadOptions=a},e._writeKey="NYcqWZ8sgOCplYnItFyBaZ5ZRClWlVgl",e.SNIPPET_VERSION="4.16.1",e.load("NYcqWZ8sgOCplYnItFyBaZ5ZRClWlVgl")}}()</script>
<script>window._docusaurusPluginSegment={},window._docusaurusPluginSegment.excludeUserAgents=["GoogleSecurityScanner"]</script>


<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-NM4PR4J9",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JH1SJHJQXJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JH1SJHJQXJ",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0J3TM1K4Z4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0J3TM1K4Z4",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.213166a2.css">
<script src="/assets/js/runtime~main.d8da5ad1.js" defer="defer"></script>
<script src="/assets/js/main.e6b4d9a2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>



<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NM4PR4J9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">W&amp;B Weave</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Documentation</a><a class="navbar__item navbar__link" href="/reference/gen_notebooks/intro_notebook">Cookbooks</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/guides/platform/weave-self-managed">Reference</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/reference/python-sdk/weave/">Python SDK</a></li><li><a class="dropdown__link" href="/reference/typescript-sdk/weave/">TypeScript SDK</a></li><li><a class="dropdown__link" href="/reference/service-api/export-trace-otel-v-1-traces-post">Service API</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/guides/platform/weave-self-managed">Open Source</a><ul class="dropdown__menu"><li><a href="https://github.com/wandb/weave" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/wandb/weave/releases" target="_blank" rel="noopener noreferrer" class="dropdown__link">Release Changelog<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/guides/platform/weave-self-managed">Community</a><ul class="dropdown__menu"><li><a href="https://www.wandb.courses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">LLM Courses<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://community.wandb.ai" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://twitter.com/weights_biases" target="_blank" rel="noopener noreferrer" class="dropdown__link">Twitter<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><a href="https://wandb.ai/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link button button--secondary button--med margin-right--sm">Open App</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-section-title"><div class="menu__list-item-collapsible"><a class="menu__link">👋 Introduction</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/">W&amp;B Weave</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quickstart">Quickstart: Track LLM Calls</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-section-title"><div class="menu__list-item-collapsible"><a class="menu__link">🔄 Iteration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorial-tracing_2">Track Application Logic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/guides/tracking/tracing">Tracing &amp; Debugging</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tracking/tracing">Tracing Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tracking/costs">Costs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/core-types/media">Logging Media</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tools/playground">Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/integrations/">Integrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tools/saved-views">Saved Views</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tools/comparison">Compare Traces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tracking/trace-tree">Navigate the Trace View</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tracking/otel">Send OpenTelemetry Traces to Weave</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tutorial-weave_models">Version Control for Models &amp; Prompts</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-section-title"><div class="menu__list-item-collapsible"><a class="menu__link">📊 Evaluation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorial-eval">Build an Evaluation Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorial-rag">Evaluate a RAG App</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/guides/core-types/evaluations">Evaluations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/core-types/evaluations">Evaluation Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/core-types/datasets">Datasets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/evaluation/scorers">Scoring Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/evaluation/builtin_scorers">Builtin Scorers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/evaluation/weave_local_scorers">Weave Local Scorers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/evaluation/evaluation_logger">EvaluationLogger</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-section-title"><div class="menu__list-item-collapsible"><a class="menu__link">🚀 Productionization</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/guides/tracking/feedback">Collect Feedback &amp; Examples</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tracking/feedback">Feedback</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tracking/redact-pii">Redacting PII</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/guides/evaluation/guardrails_and_monitors">Online Evaluation</a><button aria-label="Collapse sidebar category &#x27;Online Evaluation&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/evaluation/guardrails_and_monitors#using-scorers-as-guardrails">Guardrails</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/evaluation/guardrails_and_monitors#using-scorers-as-monitors">Monitors</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/guides/tools/">Tools &amp; Utilities</a><button aria-label="Expand sidebar category &#x27;Tools &amp; Utilities&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-section-title"><div class="menu__list-item-collapsible"><a class="menu__link" href="/guides/integrations/">🔥 Integrations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/guides/integrations/bedrock">LLM Providers</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/integrations/local_models">Local Models</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/guides/integrations/openai_agents">Frameworks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/guides/integrations/">Protocols</a><button aria-label="Collapse sidebar category &#x27;Protocols&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/integrations/mcp">MCP</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-section-title"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">🏭 Enterprise</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/platform/">Platform &amp; Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guides/platform/weave-self-managed">W&amp;B Weave Self-Managed</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-section-title"><div class="menu__list-item-collapsible"><a class="menu__link">🛠️ Tools &amp; Resources</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/core-types/env-vars">Environment variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/tracking/faqs">FAQs</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_xLCN"><div class="docItemContainer_jfFK"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">🏭 Enterprise</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">W&amp;B Weave Self-Managed</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="row"><div class="col col--12 markdown"><h1>W&amp;B Weave Self-Managed</h1>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>Weave on self-managed infrastructure is currently in Private Preview.</p><p>For production environments, W&amp;B strongly recommends using <a href="https://docs.wandb.ai/guides/hosting/hosting-options/dedicated_cloud" target="_blank" rel="noopener noreferrer">W&amp;B Dedicated Cloud</a>, where Weave is Generally Available.</p><p>To deploy a production-grade, self-managed instance, contact <code>support@wandb.com</code>.</p></div></div>
<p>This guide explains how to deploy all the components required to run W&amp;B Weave in a self-managed environment.</p>
<p>A key component of a self-managed Weave deployment is <a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer">ClickHouseDB</a>, which the Weave application backend relies on.</p>
<p>Although the deployment process sets up a fully functional ClickHouseDB instance, you may need to take additional steps to ensure reliability and high availability for a production-ready environment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements" href="/guides/platform/weave-self-managed#requirements">​</a></h2>
<ul>
<li>W&amp;B Platform installed. For more information, see the <a href="https://docs.wandb.ai/guides/hosting/hosting-options/self-managed/" target="_blank" rel="noopener noreferrer">Self-Managed Deployment Guide</a>.</li>
<li><a href="https://github.com/bitnami/charts/tree/main/bitnami/clickhouse" target="_blank" rel="noopener noreferrer">Bitnami&#x27;s ClickHouse Helm Chart</a>.</li>
<li>An S3 bucket pre-configured for ClickHouse storage. For configuration details, see <a href="/guides/platform/weave-self-managed#provide-s3-credentials">Provide S3 Credentials</a>.</li>
<li>Kubernetes Cluster Nodes with the following specifications:<!-- -->
<ul>
<li>CPU: 8 cores</li>
<li>RAM: 64 GB</li>
<li>Disk: 200GB+</li>
</ul>
</li>
<li>A Weave-enabled license from W&amp;B. To request a license, please contact <code>support@wandb.com</code>.</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>For a detailed reference architecture, see <a href="https://docs.wandb.ai/guides/hosting/self-managed/ref-arch/#models-and-weave" target="_blank" rel="noopener noreferrer">https://docs.wandb.ai/guides/hosting/self-managed/ref-arch/</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-configure-clickhouse">1. Configure ClickHouse<a class="hash-link" aria-label="Direct link to 1. Configure ClickHouse" title="Direct link to 1. Configure ClickHouse" href="/guides/platform/weave-self-managed#1-configure-clickhouse">​</a></h2>
<p>The ClickHouse deployment in this document uses the <a href="https://bitnami.com/stack/clickhouse" target="_blank" rel="noopener noreferrer">Bitnami ClickHouse</a> package.</p>
<p>The Bitnami Helm chart provides good support for basic ClickHouse functionalities, particularly the use of <a href="https://clickhouse.com/docs/en/guides/sre/keeper/clickhouse-keeper" target="_blank" rel="noopener noreferrer">ClickHouse Keeper</a>.</p>
<p>To configure Clickhouse, complete the following steps:</p>
<ol>
<li><a href="/guides/platform/weave-self-managed#configure-helm-repository">Configure the Helm repository</a></li>
<li><a href="/guides/platform/weave-self-managed#create-helm-configuration">Create Helm Configuration</a></li>
<li><a href="/guides/platform/weave-self-managed#provide-s3-credentials">Provide S3 credentials</a></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-helm-repository">Configure Helm repository<a class="hash-link" aria-label="Direct link to Configure Helm repository" title="Direct link to Configure Helm repository" href="/guides/platform/weave-self-managed#configure-helm-repository">​</a></h3>
<ol>
<li>
<p>Add the Bitnami Helm repository:</p>
<p><code>helm repo add bitnami https://charts.bitnami.com/bitnami</code></p>
</li>
<li>
<p>Update the repository:</p>
<p><code>helm repo update</code></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-helm-configuration">Create Helm Configuration<a class="hash-link" aria-label="Direct link to Create Helm Configuration" title="Direct link to Create Helm Configuration" href="/guides/platform/weave-self-managed#create-helm-configuration">​</a></h3>
<p>The most critical part of the Helm configuration is the ClickHouse configuration, which is provided in XML format. Below is an example <code>values.yaml</code> file with customizable parameters to suit your needs.
To make the configuration process easier, we have added comments in the relevant sections using the format <code>&lt;!-- COMMENT --&gt;</code>.</p>
<p>Modify the following parameters:</p>
<ul>
<li><code>clusterName</code></li>
<li><code>auth.username</code></li>
<li><code>auth.password</code></li>
<li>S3 bucket-related configurations</li>
</ul>
<p>W&amp;B recommends keeping the <code>clusterName</code> value in <code>values.yaml</code> set to <code>weave_cluster</code>.  This is the expected cluster name when W&amp;B Weave runs the database migration. If you need to use a different name, see the <a href="/guides/platform/weave-self-managed#setting-clustername">Setting <code>clusterName</code></a> section for more information.</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## @param clusterName ClickHouse cluster name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">clusterName</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> weave_cluster</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## @param shards Number of ClickHouse shards to deploy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">shards</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## @param replicaCount Number of ClickHouse replicas per shard to deploy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## if keeper enable, same as keeper count, keeper cluster by shards.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">replicaCount</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">persistence</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">size</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> 30G </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># this size must be larger than cache size.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## ClickHouse resource requests and limits</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">requests</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> 500Mi</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">3.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> 6Gi</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## Authentication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">auth</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> weave_admin</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;weave_123&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">existingSecret</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">existingSecretKey</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## @param logLevel Logging level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">logLevel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> information</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## @section ClickHouse keeper configuration parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">keeper</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## @param extraEnvVars Array with extra environment variables to add to ClickHouse nodes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">##</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">extraEnvVars</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> S3_ENDPOINT</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;https://s3.us-east-1.amazonaws.com/bucketname/$(CLICKHOUSE_REPLICA_ID)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## @param defaultConfigurationOverrides [string] Default configuration overrides (evaluated as a template)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">defaultConfigurationOverrides</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">|</span><span class="token scalar string" style="color:rgb(72, 118, 214)"></span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">  &lt;clickhouse&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;!-- Macros --&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;macros&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;shard from_env=&quot;CLICKHOUSE_SHARD_ID&quot;&gt;&lt;/shard&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;replica from_env=&quot;CLICKHOUSE_REPLICA_ID&quot;&gt;&lt;/replica&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;/macros&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;!-- Log Level --&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;logger&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;level&gt;{{ .Values.logLevel }}&lt;/level&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;/logger&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    {{- if or (ne (int .Values.shards) 1) (ne (int .Values.replicaCount) 1)}}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;remote_servers&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;{{ .Values.clusterName }}&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        {{- $shards := $.Values.shards | int }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        {{- range $shard, $e := until $shards }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;shard&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;internal_replication&gt;true&lt;/internal_replication&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          {{- $replicas := $.Values.replicaCount | int }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          {{- range $i, $_e := until $replicas }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;replica&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">            &lt;host&gt;{{ printf &quot;%s-shard%d-%d.%s.%s.svc.%s&quot; (include &quot;common.names.fullname&quot; $ ) $shard $i (include &quot;clickhouse.headlessServiceName&quot; $) (include &quot;common.names.namespace&quot; $) $.Values.clusterDomain }}&lt;/host&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">            &lt;port&gt;{{ $.Values.service.ports.tcp }}&lt;/port&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;/replica&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;/shard&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;/{{ .Values.clusterName }}&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;/remote_servers&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    {{- if .Values.keeper.enabled }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;keeper_server&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;tcp_port&gt;{{ $.Values.containerPorts.keeper }}&lt;/tcp_port&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- if .Values.tls.enabled }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;tcp_port_secure&gt;{{ $.Values.containerPorts.keeperSecure }}&lt;/tcp_port_secure&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;server_id from_env=&quot;KEEPER_SERVER_ID&quot;&gt;&lt;/server_id&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;log_storage_path&gt;/bitnami/clickhouse/keeper/coordination/log&lt;/log_storage_path&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;snapshot_storage_path&gt;/bitnami/clickhouse/keeper/coordination/snapshots&lt;/snapshot_storage_path&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;coordination_settings&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;operation_timeout_ms&gt;10000&lt;/operation_timeout_ms&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;session_timeout_ms&gt;30000&lt;/session_timeout_ms&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;raft_logs_level&gt;trace&lt;/raft_logs_level&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;/coordination_settings&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;raft_configuration&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        {{- $nodes := .Values.replicaCount | int }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        {{- range $node, $e := until $nodes }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;server&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;id&gt;{{ $node | int }}&lt;/id&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;hostname from_env=&quot;{{ printf &quot;KEEPER_NODE_%d&quot; $node }}&quot;&gt;&lt;/hostname&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;port&gt;{{ $.Values.service.ports.keeperInter }}&lt;/port&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;/server&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;/raft_configuration&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;/keeper_server&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    {{- if or .Values.keeper.enabled .Values.zookeeper.enabled .Values.externalZookeeper.servers }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;zookeeper&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- if or .Values.keeper.enabled }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- $nodes := .Values.replicaCount | int }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- range $node, $e := until $nodes }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;node&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;host from_env=&quot;{{ printf &quot;KEEPER_NODE_%d&quot; $node }}&quot;&gt;&lt;/host&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;port&gt;{{ $.Values.service.ports.keeper }}&lt;/port&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;/node&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- else if .Values.zookeeper.enabled }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- $nodes := .Values.zookeeper.replicaCount | int }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- range $node, $e := until $nodes }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;node&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;host from_env=&quot;{{ printf &quot;KEEPER_NODE_%d&quot; $node }}&quot;&gt;&lt;/host&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;port&gt;{{ $.Values.zookeeper.service.ports.client }}&lt;/port&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;/node&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- else if .Values.externalZookeeper.servers }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- range $node :=.Values.externalZookeeper.servers }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;node&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;host&gt;{{ $node }}&lt;/host&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;port&gt;{{ $.Values.externalZookeeper.port }}&lt;/port&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;/node&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;/zookeeper&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    {{- if .Values.metrics.enabled }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;prometheus&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;endpoint&gt;/metrics&lt;/endpoint&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;port from_env=&quot;CLICKHOUSE_METRICS_PORT&quot;&gt;&lt;/port&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;metrics&gt;true&lt;/metrics&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;events&gt;true&lt;/events&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;asynchronous_metrics&gt;true&lt;/asynchronous_metrics&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;/prometheus&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    {{- end }}</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;listen_host&gt;0.0.0.0&lt;/listen_host&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;listen_host&gt;::&lt;/listen_host&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;listen_try&gt;1&lt;/listen_try&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">    &lt;storage_configuration&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">      &lt;disks&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        &lt;s3_disk&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;type&gt;s3&lt;/type&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;endpoint from_env=&quot;S3_ENDPOINT&quot;&gt;&lt;/endpoint&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          &lt;</span><span class="token tag" style="color:rgb(153, 76, 195)">!--</span><span class="token plain"> AVOID USE CREDENTIALS CHECK THE RECOMMENDATION </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token scalar string" style="color:rgb(72, 118, 214)"></span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;access_key_id&gt;xxx&lt;/access_key_id&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;secret_access_key&gt;xxx&lt;/secret_access_key&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;!-- AVOID USE CREDENTIALS CHECK THE RECOMMENDATION --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">         &lt;metadata_path</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">/var/lib/clickhouse/disks/s3_disk/&lt;/metadata_path</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        &lt;/s3_disk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        &lt;s3_disk_cache</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  	      &lt;type</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">cache&lt;/type</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          &lt;disk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">s3_disk&lt;/disk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          &lt;path</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">/var/lib/clickhouse/s3_disk_cache/cache/&lt;/path</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          &lt;</span><span class="token tag" style="color:rgb(153, 76, 195)">!--</span><span class="token plain"> THE CACHE SIZE MUST BE LOWER THAN PERSISTENT VOLUME </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token scalar string" style="color:rgb(72, 118, 214)"></span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;max_size&gt;20Gi&lt;/max_size&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;cache_on_write_operations&gt;1&lt;/cache_on_write_operations&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">          &lt;enable_filesystem_cache_on_write_operations&gt;1&lt;/enable_filesystem_cache_on_write_operations&gt; </span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        &lt;/s3_disk_cache</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      &lt;/disks</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      &lt;policies</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        &lt;s3_main</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          &lt;volumes</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            &lt;main</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">              &lt;disk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">s3_disk_cache&lt;/disk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            &lt;/main</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          &lt;/volumes</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        &lt;/s3_main</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      &lt;/policies</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    &lt;/storage_configuration</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    &lt;merge_tree</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      &lt;storage_policy</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">s3_main&lt;/storage_policy</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    &lt;/merge_tree</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  &lt;/clickhouse</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## @section Zookeeper subchart parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">zookeeper</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">false</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="s3-endpoint-configuration">S3 endpoint configuration<a class="hash-link" aria-label="Direct link to S3 endpoint configuration" title="Direct link to S3 endpoint configuration" href="/guides/platform/weave-self-managed#s3-endpoint-configuration">​</a></h3>
<p>The bucket endpoint must be set as an environment variable to ensure each ClickHouse replica read and writes data in it&#x27;s folder in the bucket.</p>
<div class="codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">extraEnvVars:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  - name: S3_ENDPOINT</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    value: &quot;https://s3.us-east-1.amazonaws.com/bucketname/$(CLICKHOUSE_REPLICA_ID)&quot;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>Do not remove the <code>$(CLICKHOUSE_REPLICA_ID)</code> from the bucket endpoint configuration. It will ensure each ClickHouse replica is writing and reading data from it&#x27;s folder in the bucket.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="provide-s3-credentials">Provide S3 credentials<a class="hash-link" aria-label="Direct link to Provide S3 credentials" title="Direct link to Provide S3 credentials" href="/guides/platform/weave-self-managed#provide-s3-credentials">​</a></h3>
<p>You can specify credentials for accessing an S3 bucket by either hardcoding the configuration, or having ClickHouse fetch the data from environment variables or an EC2 instance.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="hardcode-the-configuration">Hardcode the configuration<a class="hash-link" aria-label="Direct link to Hardcode the configuration" title="Direct link to Hardcode the configuration" href="/guides/platform/weave-self-managed#hardcode-the-configuration">​</a></h4>
<p>Directly include the credentials in the storage configuration:</p>
<div class="language-plaintext codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-plaintext codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">&lt;type&gt;s3&lt;/type&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">&lt;endpoint from_env=&quot;S3_ENDPOINT&quot;&gt;&lt;/endpoint&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">&lt;access_key_id&gt;xxx&lt;/access_key_id&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">&lt;secret_access_key&gt;xxx&lt;/secret_access_key&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="use-environment-variables-or-ec2-metadata">Use environment variables or EC2 Metadata<a class="hash-link" aria-label="Direct link to Use environment variables or EC2 Metadata" title="Direct link to Use environment variables or EC2 Metadata" href="/guides/platform/weave-self-managed#use-environment-variables-or-ec2-metadata">​</a></h4>
<p>Instead of hardcoding credentials, you can enable ClickHouse to fetch them dynamically from environment variables or Amazon EC2 instance metadata.</p>
<div class="language-plaintext codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-plaintext codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">&lt;use_environment_credentials&gt;true&lt;/use_environment_credentials&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can find more details on this at <a href="https://clickhouse.com/docs/en/guides/separation-storage-compute" target="_blank" rel="noopener noreferrer">ClickHouse: Separation of Storage and Compute</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-install-and-deploy-clickhouse">2. Install and deploy ClickHouse<a class="hash-link" aria-label="Direct link to 2. Install and deploy ClickHouse" title="Direct link to 2. Install and deploy ClickHouse" href="/guides/platform/weave-self-managed#2-install-and-deploy-clickhouse">​</a></h2>
<p>With the repositories set up and the <code>values.yaml</code> file prepared, the next step is to install ClickHouse.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">helm install clickhouse bitnami/clickhouse -f values.yaml --version 8.0.10</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>Ensure you&#x27;re using the version <code>8.0.10</code>. The latest chart version (<code>9.0.0</code>) doesn&#x27;t work with the configuration proposed in this document.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-confirm-clickhouse-deployment">3. Confirm ClickHouse deployment<a class="hash-link" aria-label="Direct link to 3. Confirm ClickHouse deployment" title="Direct link to 3. Confirm ClickHouse deployment" href="/guides/platform/weave-self-managed#3-confirm-clickhouse-deployment">​</a></h2>
<p>Confirm that ClickHouse is deployed using the following command:</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">kubectl get pods</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see the following pods:</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">NAME                                 READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">clickhouse-shard0-0                  1/1     Running   0          9m59s</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">clickhouse-shard0-1                  1/1     Running   0          10m</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">clickhouse-shard0-2                  1/1     Running   0          10m</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-deploy-weave">4. Deploy Weave<a class="hash-link" aria-label="Direct link to 4. Deploy Weave" title="Direct link to 4. Deploy Weave" href="/guides/platform/weave-self-managed#4-deploy-weave">​</a></h2>
<p>Weave is already available for automatic deployment via <a href="https://docs.wandb.ai/guides/hosting/operator/#wb-kubernetes-operator" target="_blank" rel="noopener noreferrer">W&amp;B Operator</a>. With the W&amp;B Platform installed, complete the following steps:</p>
<ol>
<li>Edit the <a href="https://docs.wandb.ai/guides/hosting/operator/#complete-example" target="_blank" rel="noopener noreferrer">CR instance</a> used to deploy the platform.</li>
<li>Add the Weave configuration.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-gather-information">5. Gather information<a class="hash-link" aria-label="Direct link to 5. Gather information" title="Direct link to 5. Gather information" href="/guides/platform/weave-self-managed#5-gather-information">​</a></h2>
<ol>
<li>Use Kubernetes service details to configure Weave tracing:</li>
</ol>
<ul>
<li><strong>Endpoint</strong>: <code>&lt;release-name&gt;-headless.&lt;namespace&gt;.svc.cluster.local</code>
<ul>
<li>Replace <code>&lt;release-name&gt;</code> with your Helm release name</li>
<li>Replace <code>&lt;namespace&gt;</code> with your <code>NAMESPACE</code></li>
<li>Get the service details: <code>kubectl get svc -n &lt;namespace&gt;</code></li>
</ul>
</li>
<li><strong>Username</strong>: Set in the <code>values.yaml</code></li>
<li><strong>Password</strong>: Set in the <code>values.yaml</code></li>
</ul>
<ol start="2">
<li>
<p>With this information, update the W&amp;B Platform Custom Resource(CR) by adding the following configuration:</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> apps.wandb.com/v1</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> WeightsAndBiases</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">app.kubernetes.io/name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> weightsandbiases</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">app.kubernetes.io/instance</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">values</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">global</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">clickhouse</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;release</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">headless.&lt;namespace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">.svc.cluster.local</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">8123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">user</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;username</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb_weave</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># `replicated` must be set to `true` if replicating data across multiple nodes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># This is in preview, use the env var `WF_CLICKHOUSE_REPLICATED`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">replicated</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">weave-trace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">weave-trace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">install</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">extraEnv</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">WF_CLICKHOUSE_REPLICATED</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>When using more than one replica (W&amp;B recommend a least 3 replicas), ensure to have the following environment variable set for Weave Traces.</p><div class="codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-text codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">extraEnv:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  WF_CLICKHOUSE_REPLICATED: &quot;true&quot;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This has the same effect of <code>replicated: true</code> which in preview.</p></div></div>
<ol start="3">
<li>
<p>Set the <code>clusterName</code> in <code>values.yaml</code> to <code>weave_cluster</code>. If it is not, the database migration will fail.</p>
<p>Alternatively, ff you use a different cluster name, set the <code>WF_CLICKHOUSE_REPLICATED_CLUSTER</code> environment variable in <code>weave-trace.extraEnv</code> to match the chosen name, as shown in the example below.</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">clickhouse</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;release</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">headless.&lt;namespace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">.svc.cluster.local</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">8123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">user</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;username</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb_weave</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># `replicated` must be set to `true` if replicating data across multiple nodes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># This is in preview, use the env var `WF_CLICKHOUSE_REPLICATED`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">replicated</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">weave-trace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">weave-trace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">install</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">extraEnv</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">WF_CLICKHOUSE_REPLICATED</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">WF_CLICKHOUSE_REPLICATED_CLUSTER</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;different_cluster_name&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The final configuration will look like the following example:</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> apps.wandb.com/v1</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> WeightsAndBiases</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">app.kubernetes.io/name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> weightsandbiases</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">app.kubernetes.io/instance</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">values</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">global</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">license</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> eyJhbGnUzaHgyQjQyQWhEU3</span><span class="token punctuation" style="color:rgb(153, 76, 195)">...</span><span class="token plain">ZieKQ2x5GGfw</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">//wandb.example.com</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">bucket</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> abc</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">wandb</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">moving</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">pipefish</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">provider</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> gcs</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">mysql</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb_local</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> 10.218.0.2</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb_local</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> 8wtX6cJHizAZvYScjDzZcUarK4zZGjpV</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">3306</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">user</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">clickhouse</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;release</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">headless.&lt;namespace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">.svc.cluster.local</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">8123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">user</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> &lt;username</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> wandb_weave</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># This option must be true if replicating data across multiple nodes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">replicated</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">weave-trace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">ingress</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">annotations</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">ingress.gcp.kubernetes.io/pre-shared-cert</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> abc</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">wandb</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cert</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">creative</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">puma</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">kubernetes.io/ingress.class</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> gce</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">kubernetes.io/ingress.global-static-ip-name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> abc</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">wandb</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">operator</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">address</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">weave-trace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">install</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">extraEnv</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">WF_CLICKHOUSE_REPLICATED</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;true&quot;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>With the Custom Resource (CR) prepared, apply the new configuration:</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">kubectl apply -f wandb.yaml</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-access-weave">6. Access Weave<a class="hash-link" aria-label="Direct link to 6. Access Weave" title="Direct link to 6. Access Weave" href="/guides/platform/weave-self-managed#6-access-weave">​</a></h2>
<p>Once the deployment is running, accessing the W&amp;B endpoint configured in the <code>host</code> option should display the Weave licensing status as enabled.</p>
<p><img decoding="async" loading="lazy" alt="Weave" src="/assets/images/weave-org-dashboard-808eee0637ab9a486d58f0a17adeb44d.png" width="2864" height="806" class="img_ev3q"></p></div></div></div><div class="row"><div class="col col--12"><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/wandb/weave/blob/master/docs/docs/guides/platform/weave-self-managed.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-05-01T00:29:39.000Z" itemprop="dateModified">May 1, 2025</time></b></span></div></div></footer></div></div></article><div class="row"><div class="col col--12"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/guides/platform/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Platform &amp; Security</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/guides/core-types/env-vars"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Environment variables</div></a></nav></div></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#requirements">Requirements</a></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#1-configure-clickhouse">1. Configure ClickHouse</a><ul><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#configure-helm-repository">Configure Helm repository</a></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#create-helm-configuration">Create Helm Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#s3-endpoint-configuration">S3 endpoint configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#provide-s3-credentials">Provide S3 credentials</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#2-install-and-deploy-clickhouse">2. Install and deploy ClickHouse</a></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#3-confirm-clickhouse-deployment">3. Confirm ClickHouse deployment</a></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#4-deploy-weave">4. Deploy Weave</a></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#5-gather-information">5. Gather information</a></li><li><a class="table-of-contents__link toc-highlight" href="/guides/platform/weave-self-managed#6-access-weave">6. Access Weave</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Made with ❤️ by Weights & Biases</div></div></div></footer></div>
</body>
</html>