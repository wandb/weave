"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9620],{82464:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>c,toc:()=>l});var t=i(85893),s=i(11151);const d={},r="Redacting PII",c={id:"guides/tracking/redact-pii",title:"Redacting PII",description:"This feature is only accessible via the Python SDK.",source:"@site/docs/guides/tracking/redact-pii.md",sourceDirName:"guides/tracking",slug:"/guides/tracking/redact-pii",permalink:"/guides/tracking/redact-pii",draft:!1,unlisted:!1,editUrl:"https://github.com/wandb/weave/blob/master/docs/docs/guides/tracking/redact-pii.md",tags:[],version:"current",lastUpdatedAt:1744817849e3,frontMatter:{},sidebar:"documentationSidebar",previous:{title:"Feedback",permalink:"/guides/tracking/feedback"},next:{title:"Online Evaluation: Guardrails and Monitors",permalink:"/guides/evaluation/guardrails_and_monitors"}},a={},l=[{value:"Enable PII redaction",id:"enable-pii-redaction",level:2},{value:"Entities redacted by default",id:"entities-redacted-by-default",level:2},{value:"Redacting sensitive keys with <code>REDACT_KEYS</code>",id:"redacting-sensitive-keys-with-redact_keys",level:2},{value:"Pre-defined <code>REDACT_KEYS</code>",id:"pre-defined-redact_keys",level:3},{value:"Adding your own keys",id:"adding-your-own-keys",level:3},{value:"Usage information",id:"usage-information",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"redacting-pii",children:"Redacting PII"}),"\n",(0,t.jsx)(n.admonition,{type:"important",children:(0,t.jsx)(n.p,{children:"This feature is only accessible via the Python SDK."})}),"\n",(0,t.jsx)(n.p,{children:"Some organizations process Personally Identifiable Information (PII) such as names, phone numbers, and email addresses in their Large Language Model (LLM) workflows. Storing this data in Weights & Biases (W&B) Weave poses compliance and security risks."}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.em,{children:"Sensitive Data Protection"})," feature allows you to automatically redact Personally Identifiable Information (PII) from a ",(0,t.jsx)(n.a,{href:"/guides/tracking/",children:"trace"})," before it is sent to Weave servers. This feature integrates ",(0,t.jsx)(n.a,{href:"https://microsoft.github.io/presidio/",children:"Microsoft Presidio"})," into the Weave Python SDK, which means that you can control redaction settings at the SDK level."]}),"\n",(0,t.jsx)(n.p,{children:"The Sensitive Data Protection feature introduces the following functionality to the Python SDK:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["A ",(0,t.jsx)(n.code,{children:"redact_pii"})," setting, which can be toggled on or off in the ",(0,t.jsx)(n.code,{children:"weave.init"})," call to enable PII redaction."]}),"\n",(0,t.jsxs)(n.li,{children:["Automatic redaction of ",(0,t.jsx)(n.a,{href:"#entities-redacted-by-default",children:"common entities"})," when ",(0,t.jsx)(n.code,{children:"redact_pii = True"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Customizable redaction fields using the configurable ",(0,t.jsx)(n.code,{children:"redact_pii_fields"})," setting."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"enable-pii-redaction",children:"Enable PII redaction"}),"\n",(0,t.jsx)(n.p,{children:"To get started with the Sensitive Data Protection feature in Weave, complete the following steps:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Install the required dependencies:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pip install presidio-analyzer presidio-anonymizer\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Modify your ",(0,t.jsx)(n.code,{children:"weave.init"})," call to enable redaction. When ",(0,t.jsx)(n.code,{children:"redact_pii=True"}),", ",(0,t.jsx)(n.a,{href:"#entities-redacted-by-default",children:"common entities are redacted by default"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import weave\n\nweave.init("my-project", settings={"redact_pii": True})\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["(Optional) Customize redaction fields using the ",(0,t.jsx)(n.code,{children:"redact_pii_fields"})," parameter:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'weave.init("my-project", settings={"redact_pii": True, "redact_pii_fields":["CREDIT_CARD", "US_SSN"]})\n'})}),"\n",(0,t.jsxs)(n.p,{children:["For a full list of the entities that can be detected and redacted, see ",(0,t.jsx)(n.a,{href:"https://microsoft.github.io/presidio/supported_entities/",children:"PII entities supported by Presidio"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"entities-redacted-by-default",children:"Entities redacted by default"}),"\n",(0,t.jsx)(n.p,{children:"The following entities are automatically redacted when PII redaction is enabled:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"CREDIT_CARD"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"CRYPTO"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"EMAIL_ADDRESS"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"ES_NIF"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"FI_PERSONAL_IDENTITY_CODE"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"IBAN_CODE"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"IN_AADHAAR"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"IN_PAN"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"IP_ADDRESS"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"LOCATION"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"PERSON"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"PHONE_NUMBER"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"UK_NHS"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"UK_NINO"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"US_BANK_NUMBER"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"US_DRIVER_LICENSE"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"US_PASSPORT"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"US_SSN"})}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"redacting-sensitive-keys-with-redact_keys",children:["Redacting sensitive keys with ",(0,t.jsx)(n.code,{children:"REDACT_KEYS"})]}),"\n",(0,t.jsxs)(n.p,{children:["In addition to PII redaction, the Weave SDK also supports redaction of custom keys using ",(0,t.jsx)(n.code,{children:"REDACT_KEYS"}),". This is useful when you want to protect additional sensitive data that might not fall under the PII category but needs to be kept private. Examples include:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"API keys"}),"\n",(0,t.jsx)(n.li,{children:"Authentication headers"}),"\n",(0,t.jsx)(n.li,{children:"Tokens"}),"\n",(0,t.jsx)(n.li,{children:"Internal IDs"}),"\n",(0,t.jsx)(n.li,{children:"Config values"}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"pre-defined-redact_keys",children:["Pre-defined ",(0,t.jsx)(n.code,{children:"REDACT_KEYS"})]}),"\n",(0,t.jsx)(n.p,{children:"Weave automatically redacts the following sensitive keys by default:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'[\n  "api_key",\n  "auth_headers",\n  "authorization"\n]\n'})}),"\n",(0,t.jsx)(n.h3,{id:"adding-your-own-keys",children:"Adding your own keys"}),"\n",(0,t.jsx)(n.p,{children:"You can extend this list with your own custom keys that you want to redact from traces:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import weave\n\nclient = weave.init("my-project")\n\n# Add custom keys to redact\nweave.trace.sanitize.REDACT_KEYS.add("client_id")\nweave.trace.sanitize.REDACT_KEYS.add("whatever_else")\n\nclient_id = "123"\nwhatever_else = "456"\n\n@weave.op()\ndef test():\n    a = client_id\n    b = whatever_else\n    return 1\n'})}),"\n",(0,t.jsxs)(n.p,{children:["When viewed in the Weave UI, the values of ",(0,t.jsx)(n.code,{children:"client_id"})," and ",(0,t.jsx)(n.code,{children:"whatever_else"})," will appear as ",(0,t.jsx)(n.code,{children:'"REDACTED"'}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'client_id = "REDACTED"\nwhatever_else = "REDACTED"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"usage-information",children:"Usage information"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"This feature is only available in the Python SDK."}),"\n",(0,t.jsx)(n.li,{children:"Enabling redaction increases processing time due to the Presidio dependency."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>c,a:()=>r});var t=i(67294);const s={},d=t.createContext(s);function r(e){const n=t.useContext(d);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(d.Provider,{value:n},e.children)}}}]);