"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4016],{46656:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var o=t(85893),r=t(11151);const s={},i="Google Agent Development Kit (ADK)",a={id:"guides/integrations/google_adk",title:"Google Agent Development Kit (ADK)",description:"You can trace Google Agent Development Kit (ADK) agent and tool calls in Weave using OpenTelemetry (OTEL). ADK is a flexible and modular framework for developing and deploying AI agents. While optimized for Gemini and the Google ecosystem, ADK is model-agnostic and deployment-agnostic. It provides tools for creating, deploying, and orchestrating agentic architectures ranging from simple tasks to complex workflows.",source:"@site/docs/guides/integrations/google_adk.md",sourceDirName:"guides/integrations",slug:"/guides/integrations/google_adk",permalink:"/guides/integrations/google_adk",draft:!1,unlisted:!1,editUrl:"https://github.com/wandb/weave/blob/master/docs/docs/guides/integrations/google_adk.md",tags:[],version:"current",lastUpdatedAt:1749652482e3,frontMatter:{},sidebar:"documentationSidebar",previous:{title:"PydanticAI",permalink:"/guides/integrations/pydantic_ai"},next:{title:"TypeScript SDK: Third-Party Integration Guide",permalink:"/guides/integrations/js"}},l={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Configure OTEL tracing in Weave",id:"configure-otel-tracing-in-weave",level:3},{value:"Required configuration",id:"required-configuration",level:3},{value:"Send OTEL traces from ADK to Weave",id:"send-otel-traces-from-adk-to-weave",level:2},{value:"Trace ADK Agents with OTEL",id:"trace-adk-agents-with-otel",level:2},{value:"Trace ADK Tools with OTEL",id:"trace-adk-tools-with-otel",level:2},{value:"Work with Workflow Agents",id:"work-with-workflow-agents",level:2},{value:"Learn more",id:"learn-more",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"google-agent-development-kit-adk",children:"Google Agent Development Kit (ADK)"}),"\n",(0,o.jsxs)(n.p,{children:["You can trace ",(0,o.jsx)(n.a,{href:"https://google.github.io/adk-docs/",children:"Google Agent Development Kit (ADK)"})," agent and tool calls in Weave using ",(0,o.jsx)(n.a,{href:"https://opentelemetry.io/",children:"OpenTelemetry (OTEL)"}),". ADK is a flexible and modular framework for developing and deploying AI agents. While optimized for Gemini and the Google ecosystem, ADK is model-agnostic and deployment-agnostic. It provides tools for creating, deploying, and orchestrating agentic architectures ranging from simple tasks to complex workflows."]}),"\n",(0,o.jsx)(n.p,{children:"This guide explains how to trace ADK agent and tool calls using OTEL, and visualize those traces in Weave. You'll learn how to install the required dependencies, configure an OTEL tracer to send data to Weave, and instrument your ADK agents and tools."}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["For more information on OTEL tracing in Weave, see ",(0,o.jsx)(n.a,{href:"/guides/tracking/otel",children:"Send OTEL Traces to Weave"}),"."]})}),"\n",(0,o.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Install the required dependencies:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"pip install google-adk opentelemetry-sdk opentelemetry-exporter-otlp-proto-http\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Set your ",(0,o.jsx)(n.a,{href:"https://cloud.google.com/docs/authentication/api-keys",children:"Google API key"})," as an environment variable:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"export GOOGLE_API_KEY=your_api_key_here\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"#configure-otel-tracing-in-weave",children:"Configure OTEL tracing in Weave"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"configure-otel-tracing-in-weave",children:"Configure OTEL tracing in Weave"}),"\n",(0,o.jsxs)(n.p,{children:["To send traces from ADK to Weave, configure OTEL with a ",(0,o.jsx)(n.code,{children:"TracerProvider"})," and an ",(0,o.jsx)(n.code,{children:"OTLPSpanExporter"}),". Set the exporter to the ",(0,o.jsx)(n.a,{href:"#required-configuration",children:"correct endpoint and HTTP headers for authentication and project identification"}),"."]}),"\n",(0,o.jsxs)(n.admonition,{type:"important",children:[(0,o.jsx)(n.mdxAdmonitionTitle,{}),(0,o.jsxs)(n.p,{children:["It is recommended that you store sensitive environment variables like your API key and project info in an environment file (e.g., ",(0,o.jsx)(n.code,{children:".env"}),"), and load them using ",(0,o.jsx)(n.code,{children:"os.environ"}),". This keeps your credentials secure and out of your codebase."]})]}),"\n",(0,o.jsx)(n.h3,{id:"required-configuration",children:"Required configuration"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Endpoint:"})," ",(0,o.jsx)(n.code,{children:"https://trace.wandb.ai/otel/v1/traces"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Headers:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Authorization"}),": Basic auth using your W&B API key"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"project_id"}),": Your W&B entity/project name (e.g., ",(0,o.jsx)(n.code,{children:"myteam/myproject"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"send-otel-traces-from-adk-to-weave",children:"Send OTEL traces from ADK to Weave"}),"\n",(0,o.jsx)(n.p,{children:"The following code snippet demonstrates how to configure an OTLP span exporter and tracer provider to send OTEL traces from an ADK application to Weave."}),"\n",(0,o.jsx)(n.admonition,{type:"important",children:(0,o.jsxs)(n.p,{children:["To ensure that Weave traces ADK properly, set the global tracer provider ",(0,o.jsx)(n.em,{children:"before"})," using ADK components in your code."]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'import base64\nimport os\nfrom opentelemetry.exporter.otlp.proto.http.trace_exporter import OTLPSpanExporter\nfrom opentelemetry.sdk import trace as trace_sdk\nfrom opentelemetry.sdk.trace.export import SimpleSpanProcessor\nfrom opentelemetry import trace\n\n# Load sensitive values from environment variables\nWANDB_BASE_URL = "https://trace.wandb.ai"\n# Your W&B entity/project name e.g. "myteam/myproject"\nPROJECT_ID = os.environ.get("WANDB_PROJECT_ID")  \n# Your W&B API key (found at https://wandb.ai/authorize)\nWANDB_API_KEY = os.environ.get("WANDB_API_KEY")  \n\nOTEL_EXPORTER_OTLP_ENDPOINT = f"{WANDB_BASE_URL}/otel/v1/traces"\nAUTH = base64.b64encode(f"api:{WANDB_API_KEY}".encode()).decode()\n\nOTEL_EXPORTER_OTLP_HEADERS = {\n    "Authorization": f"Basic {AUTH}",\n    "project_id": PROJECT_ID,\n}\n\n# Create the OTLP span exporter with endpoint and headers\nexporter = OTLPSpanExporter(\n    endpoint=OTEL_EXPORTER_OTLP_ENDPOINT,\n    headers=OTEL_EXPORTER_OTLP_HEADERS,\n)\n\n# Create a tracer provider and add the exporter\ntracer_provider = trace_sdk.TracerProvider()\ntracer_provider.add_span_processor(SimpleSpanProcessor(exporter))\n\n# Set the global tracer provider BEFORE importing/using ADK\ntrace.set_tracer_provider(tracer_provider)\n'})}),"\n",(0,o.jsx)(n.h2,{id:"trace-adk-agents-with-otel",children:"Trace ADK Agents with OTEL"}),"\n",(0,o.jsx)(n.p,{children:"After setting up the tracer provider, you can create and run ADK agents with automatic tracing. The following example demonstrates how to create a simple LLM agent with a tool, and run it with an in-memory runner:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'from google.adk.agents import LlmAgent\nfrom google.adk.runners import InMemoryRunner\nfrom google.adk.tools import FunctionTool\nfrom google.genai import types\nimport asyncio\n\n# Define a simple tool for demonstration\ndef calculator(a: float, b: float) -> str:\n    """Add two numbers and return the result.\n\n    Args:\n        a: First number\n        b: Second number\n\n    Returns:\n        The sum of a and b\n    """\n    return str(a + b)\n\ncalculator_tool = FunctionTool(func=calculator)\n\nasync def run_agent():\n    # Create an LLM agent\n    agent = LlmAgent(\n        name="MathAgent",\n        model="gemini-2.0-flash",  # You can change this to another model if needed\n        instruction=(\n            "You are a helpful assistant that can do math. "\n            "When asked a math problem, use the calculator tool to solve it."\n        ),\n        tools=[calculator_tool],\n    )\n\n    # Set up runner\n    runner = InMemoryRunner(agent=agent, app_name="math_assistant")\n    session_service = runner.session_service\n\n    # Create a session\n    user_id = "example_user"\n    session_id = "example_session"\n    session_service.create_session(\n        app_name="math_assistant",\n        user_id=user_id,\n        session_id=session_id,\n    )\n\n    # Run the agent with a message that should trigger tool use\n    async for event in runner.run_async(\n        user_id=user_id,\n        session_id=session_id,\n        new_message=types.Content(\n            role="user", parts=[types.Part(text="What is 5 + 7?")]\n        ),\n    ):\n        if event.is_final_response() and event.content:\n            print(f"Final response: {event.content.parts[0].text.strip()}")\n\n# Run the async function\nasyncio.run(run_agent())\n'})}),"\n",(0,o.jsx)(n.p,{children:"All agent operations are automatically traced and sent to Weave, allowing you to visualize the execution flow. You can view model calls, reasoning steps, and tool invocations."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"A trace visualization of an ADK agent",src:t(8449).Z+"",width:"3016",height:"1594"})}),"\n",(0,o.jsx)(n.h2,{id:"trace-adk-tools-with-otel",children:"Trace ADK Tools with OTEL"}),"\n",(0,o.jsx)(n.p,{children:"When you define and use tools with ADK, these tool calls are also captured in the trace. The OTEL integration automatically instruments both the agent's reasoning process and the individual tool executions, providing a comprehensive view of your agent's behavior."}),"\n",(0,o.jsx)(n.p,{children:"Here's an example with multiple tools:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'from google.adk.agents import LlmAgent\nfrom google.adk.runners import InMemoryRunner\nfrom google.adk.tools import FunctionTool\nfrom google.genai import types\nimport asyncio\n\n# Define multiple tools\ndef add(a: float, b: float) -> str:\n    """Add two numbers.\n    \n    Args:\n        a: First number\n        b: Second number\n        \n    Returns:\n        The sum of a and b\n    """\n    return str(a + b)\n\ndef multiply(a: float, b: float) -> str:\n    """Multiply two numbers.\n    \n    Args:\n        a: First number\n        b: Second number\n        \n    Returns:\n        The product of a and b\n    """\n    return str(a * b)\n\n# Create function tools\nadd_tool = FunctionTool(func=add)\nmultiply_tool = FunctionTool(func=multiply)\n\nasync def run_agent():\n    # Create an LLM agent with multiple tools\n    agent = LlmAgent(\n        name="MathAgent",\n        model="gemini-2.0-flash",\n        instruction=(\n            "You are a helpful assistant that can do math operations. "\n            "When asked to add numbers, use the add tool. "\n            "When asked to multiply numbers, use the multiply tool."\n        ),\n        tools=[add_tool, multiply_tool],\n    )\n\n    # Set up runner\n    runner = InMemoryRunner(agent=agent, app_name="math_assistant")\n    session_service = runner.session_service\n\n    # Create a session\n    user_id = "example_user"\n    session_id = "example_session"\n    session_service.create_session(\n        app_name="math_assistant",\n        user_id=user_id,\n        session_id=session_id,\n    )\n\n    # Run the agent with a message that should trigger tool use\n    async for event in runner.run_async(\n        user_id=user_id,\n        session_id=session_id,\n        new_message=types.Content(\n            role="user", parts=[types.Part(text="First add 5 and 7, then multiply the result by 2.")]\n        ),\n    ):\n        if event.is_final_response() and event.content:\n            print(f"Final response: {event.content.parts[0].text.strip()}")\n\n# Run the async function\nasyncio.run(run_agent())\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"A trace visualization of ADK tool calls",src:t(83831).Z+"",width:"3012",height:"1590"})}),"\n",(0,o.jsx)(n.h2,{id:"work-with-workflow-agents",children:"Work with Workflow Agents"}),"\n",(0,o.jsxs)(n.p,{children:["ADK provides various ",(0,o.jsx)(n.a,{href:"https://google.github.io/adk-docs/agents/workflow-agents/",children:(0,o.jsx)(n.em,{children:"workflow agents"})})," for more complex scenarios. You can trace workflow agents just like regular LLM agents. Here's an example using a ",(0,o.jsx)(n.a,{href:"https://google.github.io/adk-docs/agents/workflow-agents/sequential-agents/",children:(0,o.jsx)(n.code,{children:"SequentialAgent"})}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'from google.adk.agents import LlmAgent, SequentialAgent\nfrom google.adk.runners import InMemoryRunner\nfrom google.genai import types\nimport asyncio\n\nasync def run_workflow():\n    # Create two LLM agents\n    summarizer = LlmAgent(\n        name="Summarizer",\n        model="gemini-2.0-flash",\n        instruction="Summarize the given text in one sentence.",\n        description="Summarizes text in one sentence",\n        output_key="summary"  # Store output in state[\'summary\']\n    )\n    \n    analyzer = LlmAgent(\n        name="Analyzer",\n        model="gemini-2.0-flash",\n        instruction="Analyze the sentiment of the given text as positive, negative, or neutral. The text to analyze: {summary}",\n        description="Analyzes sentiment of text",\n        output_key="sentiment"  # Store output in state[\'sentiment\']\n    )\n    \n    # Create a sequential workflow\n    workflow = SequentialAgent(\n        name="TextProcessor",\n        sub_agents=[summarizer, analyzer],\n        description="Executes a sequence of summarization followed by sentiment analysis.",\n    )\n    \n    # Set up runner\n    runner = InMemoryRunner(agent=workflow, app_name="text_processor")\n    session_service = runner.session_service\n    \n    # Create a session\n    user_id = "example_user"\n    session_id = "example_session"\n    session_service.create_session(\n        app_name="text_processor",\n        user_id=user_id,\n        session_id=session_id,\n    )\n    \n    # Run the workflow\n    async for event in runner.run_async(\n        user_id=user_id,\n        session_id=session_id,\n        new_message=types.Content(\n            role="user", \n            parts=[types.Part(text="The product exceeded my expectations. It worked perfectly right out of the box, and the customer service was excellent when I had questions about setup.")]\n        ),\n    ):\n        if event.is_final_response() and event.content:\n            print(f"Final response: {event.content.parts[0].text.strip()}")\n\n# Run the async function\nasyncio.run(run_workflow())\n'})}),"\n",(0,o.jsx)(n.p,{children:"This workflow agent trace will show the sequential execution of both agents in Weave, providing visibility into how data flows through your multi-agent system."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"A trace visualization of a Sequential workflow agent",src:t(91090).Z+"",width:"3020",height:"1590"})}),"\n",(0,o.jsx)(n.h2,{id:"learn-more",children:"Learn more"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/guides/tracking/otel",children:"Weave documentation: Send OTEL traces to Weave"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://google.github.io/adk-docs/",children:"Official ADK documentation"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://opentelemetry.io/",children:"Official OTEL documentation"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/google/adk-python",children:"ADK GitHub repository"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8449:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/adk_agent_trace-b8f4b748345f94b838a82e61fcfc50d3.png"},83831:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/adk_tool_calls-1c264e251fd0847fbd109b31d1334bf9.png"},91090:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/adk_workflow_trace-409247aac2d077bb1b1a4f8904569b53.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>i});var o=t(67294);const r={},s=o.createContext(r);function i(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);