"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3694],{58516:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>d});var s=n(85893),i=n(11151);const c={sidebar_label:"query"},t="weave.trace_server.interface.query",a={id:"reference/python-sdk/weave/trace_server/interface/weave.trace_server.interface.query",title:"weave.trace_server.interface.query",description:"This file contains the interface definition for the Trace Server Query model. It",source:"@site/docs/reference/python-sdk/weave/trace_server/interface/weave.trace_server.interface.query.md",sourceDirName:"reference/python-sdk/weave/trace_server/interface",slug:"/reference/python-sdk/weave/trace_server/interface/weave.trace_server.interface.query",permalink:"/reference/python-sdk/weave/trace_server/interface/weave.trace_server.interface.query",draft:!1,unlisted:!1,editUrl:"https://github.com/wandb/weave/blob/master/docs/docs/reference/python-sdk/weave/trace_server/interface/weave.trace_server.interface.query.md",tags:[],version:"current",lastUpdatedAt:1746465007e3,frontMatter:{sidebar_label:"query"},sidebar:"pythonSdkSidebar",previous:{title:"weave_client",permalink:"/reference/python-sdk/weave/trace/weave.trace.weave_client"},next:{title:"trace_server_interface",permalink:"/reference/python-sdk/weave/trace_server/weave.trace_server.trace_server_interface"}},l={},d=[{value:"Classes",id:"classes",level:2},{value:"<kbd>class</kbd> <code>AndOperation</code>",id:"class-andoperation",level:2},{value:"<kbd>class</kbd> <code>ContainsOperation</code>",id:"class-containsoperation",level:2},{value:"<kbd>class</kbd> <code>ContainsSpec</code>",id:"class-containsspec",level:2},{value:"<kbd>class</kbd> <code>ConvertOperation</code>",id:"class-convertoperation",level:2},{value:"<kbd>class</kbd> <code>ConvertSpec</code>",id:"class-convertspec",level:2},{value:"<kbd>class</kbd> <code>EqOperation</code>",id:"class-eqoperation",level:2},{value:"<kbd>class</kbd> <code>GetFieldOperator</code>",id:"class-getfieldoperator",level:2},{value:"<kbd>class</kbd> <code>GtOperation</code>",id:"class-gtoperation",level:2},{value:"<kbd>class</kbd> <code>GteOperation</code>",id:"class-gteoperation",level:2},{value:"<kbd>class</kbd> <code>InOperation</code>",id:"class-inoperation",level:2},{value:"<kbd>class</kbd> <code>LiteralOperation</code>",id:"class-literaloperation",level:2},{value:"<kbd>class</kbd> <code>NotOperation</code>",id:"class-notoperation",level:2},{value:"<kbd>class</kbd> <code>OrOperation</code>",id:"class-oroperation",level:2},{value:"<kbd>class</kbd> <code>Query</code>",id:"class-query",level:2}];function o(e){const r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h1,{id:"weavetrace_serverinterfacequery",children:"weave.trace_server.interface.query"}),"\n",(0,s.jsx)(r.p,{children:"This file contains the interface definition for the Trace Server Query model. It\nis heavily inspired by the MongoDB query language, but is a subset of the full\nMongoDB query language. In particular, we have made the following\nsimplifications:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:'We only support the "aggregation" operators, not the "query" operators. This is\npurely for simplicity and because the "aggregation" operators are more powerful.\nThe Mongo docs language has evolved over time and the primary query language\nis column-oriented. However, the more expressive aggregation language can be\nused for both direct queries, but also for column comparison and\ncalculations. We can add support for the "query" operators in the future if\nneeded.'}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"We only support a subset of the operators / shorthand forms for now. We can add\nmore operators in the future as needed."}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:'One notable omission here is the lack of support for "$field" as a shorthand for\nthe "getField"  operator.'}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["We have ",(0,s.jsx)(r.em,{children:"added"})," a ",(0,s.jsx)(r.code,{children:"$contains"})," operator which is not in the MongoDB query\nlanguage. This is a simple substring match operator."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h1,{id:"api-overview",children:"API Overview"}),"\n",(0,s.jsx)(r.h2,{id:"classes",children:"Classes"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-andoperation",children:(0,s.jsx)(r.code,{children:"query.AndOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-containsoperation",children:(0,s.jsx)(r.code,{children:"query.ContainsOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-containsspec",children:(0,s.jsx)(r.code,{children:"query.ContainsSpec"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-convertoperation",children:(0,s.jsx)(r.code,{children:"query.ConvertOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-convertspec",children:(0,s.jsx)(r.code,{children:"query.ConvertSpec"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-eqoperation",children:(0,s.jsx)(r.code,{children:"query.EqOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-getfieldoperator",children:(0,s.jsx)(r.code,{children:"query.GetFieldOperator"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-gtoperation",children:(0,s.jsx)(r.code,{children:"query.GtOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-gteoperation",children:(0,s.jsx)(r.code,{children:"query.GteOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-inoperation",children:(0,s.jsx)(r.code,{children:"query.InOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-literaloperation",children:(0,s.jsx)(r.code,{children:"query.LiteralOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-notoperation",children:(0,s.jsx)(r.code,{children:"query.NotOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-oroperation",children:(0,s.jsx)(r.code,{children:"query.OrOperation"})})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#class-query",children:(0,s.jsx)(r.code,{children:"query.Query"})})}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L85",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-andoperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"AndOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$and"}),": ",(0,s.jsx)(r.code,{children:"list['Operand']"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L123",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-containsoperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"ContainsOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$contains"}),": ",(0,s.jsx)(r.code,{children:"<class 'ContainsSpec'>"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L127",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-containsspec",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"ContainsSpec"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"input"}),": ",(0,s.jsx)(r.code,{children:"typing.Union[LiteralOperation, GetFieldOperator, ConvertOperation, AndOperation, OrOperation, NotOperation, EqOperation, GtOperation, GteOperation, InOperation, ContainsOperation]"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"substr"}),": ",(0,s.jsx)(r.code,{children:"typing.Union[LiteralOperation, GetFieldOperator, ConvertOperation, AndOperation, OrOperation, NotOperation, EqOperation, GtOperation, GteOperation, InOperation, ContainsOperation]"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"case_insensitive"}),": ",(0,s.jsx)(r.code,{children:"typing.Optional[bool]"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L71",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-convertoperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"ConvertOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$convert"}),": ",(0,s.jsx)(r.code,{children:"<class 'ConvertSpec'>"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L78",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-convertspec",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"ConvertSpec"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"input"}),": ",(0,s.jsx)(r.code,{children:"typing.Union[LiteralOperation, GetFieldOperator, ConvertOperation, AndOperation, OrOperation, NotOperation, EqOperation, GtOperation, GteOperation, InOperation, ContainsOperation]"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"to"}),": ",(0,s.jsx)(r.code,{children:"typing.Literal['double', 'string', 'int', 'bool', 'exists']"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L100",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-eqoperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"EqOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$eq"}),": ",(0,s.jsx)(r.code,{children:"tuple['Operand', 'Operand']"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L56",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-getfieldoperator",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"GetFieldOperator"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$getField"}),": ",(0,s.jsx)(r.code,{children:"<class 'str'>"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L105",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-gtoperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"GtOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$gt"}),": ",(0,s.jsx)(r.code,{children:"tuple['Operand', 'Operand']"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L110",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-gteoperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"GteOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$gte"}),": ",(0,s.jsx)(r.code,{children:"tuple['Operand', 'Operand']"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L115",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-inoperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"InOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$in"}),": ",(0,s.jsx)(r.code,{children:"tuple['Operand', list['Operand']]"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L38",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-literaloperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"LiteralOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$literal"}),": ",(0,s.jsx)(r.code,{children:"typing.Union[str, int, float, bool, dict[str, 'LiteralOperation'], list['LiteralOperation'], NoneType]"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L95",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-notoperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"NotOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$not"}),": ",(0,s.jsx)(r.code,{children:"tuple['Operand']"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L90",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-oroperation",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"OrOperation"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$or"}),": ",(0,s.jsx)(r.code,{children:"list['Operand']"})]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/weave/trace_server/interface/query.py#L159",children:(0,s.jsx)("img",{align:"right",src:"https://img.shields.io/badge/-source-cccccc?style=flat-square"})}),"\n",(0,s.jsxs)(r.h2,{id:"class-query",children:[(0,s.jsx)("kbd",{children:"class"})," ",(0,s.jsx)(r.code,{children:"Query"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Pydantic Fields:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"$expr"}),": ",(0,s.jsx)(r.code,{children:"typing.Union[AndOperation, OrOperation, NotOperation, EqOperation, GtOperation, GteOperation, InOperation, ContainsOperation]"})]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.a)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},11151:(e,r,n)=>{n.d(r,{Z:()=>a,a:()=>t});var s=n(67294);const i={},c=s.createContext(i);function t(e){const r=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(c.Provider,{value:r},e.children)}}}]);