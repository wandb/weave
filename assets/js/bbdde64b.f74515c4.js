"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1109],{70814:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var a=t(85893),o=t(11151);const s={},r="Log traces during model training runs",i={id:"guides/tools/weave-in-workspaces",title:"Log traces during model training runs",description:"Weave Trace in Workspaces",source:"@site/docs/guides/tools/weave-in-workspaces.md",sourceDirName:"guides/tools",slug:"/guides/tools/weave-in-workspaces",permalink:"/guides/tools/weave-in-workspaces",draft:!1,unlisted:!1,editUrl:"https://github.com/wandb/weave/blob/master/docs/docs/guides/tools/weave-in-workspaces.md",tags:[],version:"current",lastUpdatedAt:17603673e5,frontMatter:{},sidebar:"documentationSidebar",previous:{title:"Trace Plots",permalink:"/guides/tracking/trace-plots"},next:{title:"App Versioning",permalink:"/tutorial-weave_models"}},c={},l=[{value:"Use Weave Panels",id:"use-weave-panels",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"log-traces-during-model-training-runs",children:"Log traces during model training runs"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Weave Trace in Workspaces",src:t(6139).Z+"",width:"2470",height:"1200"})}),"\n",(0,a.jsx)(n.p,{children:"You can now log Weave traces during model training runs and view them in your personal workspace."}),"\n",(0,a.jsx)(n.p,{children:"Personal workspaces are customizable dashboards in the UI that allow you to view in-depth analysis and data visualizations of your model training runs. By adding Weave panels to your workspace, you can view and access trace data logged during model runs to help gain better insight into how your models perform during training."}),"\n",(0,a.jsx)(n.p,{children:"For example, if you're fine-tuning an LLM model and your W&B workspace shows that accuracy drops at step 500, the integrated Weave traces can reveal exactly what happened, such as your model started generating overly verbose responses that failed the evaluation criteria."}),"\n",(0,a.jsx)(n.h2,{id:"use-weave-panels",children:"Use Weave Panels"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsxs)(n.a,{href:"/quickstart",children:["By decorating the functions with ",(0,a.jsx)(n.code,{children:"@weave.op"})]})," in your ML-pipelines, you automatically capture their execution information and access it in a personal workspace."]}),"\n",(0,a.jsxs)(n.p,{children:["For example, the following script demonstrates how Weave traces integrate with W&B training runs. It simulates a machine learning training loop where each training step logs metrics to W&B while simultaneously creating detailed Weave traces. The ",(0,a.jsx)(n.code,{children:"@weave.op"})," decorators on the functions automatically capture inputs, outputs, and execution details. When the training loop logs metrics with ",(0,a.jsx)(n.code,{children:"wandb.log()"}),", it also logs Weave trace information to your project."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'import wandb\nimport weave\nimport random\n\n# Initialize both W&B and Weave with the same project\nproject = "my-workspace-project"\nweave.init(project)\n\n@weave.op\ndef evaluate_model(model_state, epoch):\n    # Simulate evaluation metrics\n    accuracy = 0.7 + epoch * 0.02 + random.uniform(-0.05, 0.05)\n    \n    # Track specific model behaviors\n    test_responses = {\n        "conciseness_check": "Model generated 500 words for simple question",\n        "accuracy_check": "Model answered 8/10 questions correctly",\n        "hallucination_check": "No factual errors detected"\n    }\n    \n    return {\n        "accuracy": accuracy,\n        "diagnostic_results": test_responses\n    }\n\n@weave.op\ndef training_step(epoch, lr):\n    # Simulate Training logic\n    loss = 1.0 / (epoch + 1) + random.uniform(-0.1, 0.1)\n    \n    # Evaluation with traces\n    eval_results = evaluate_model(f"checkpoint_{epoch}", epoch)\n    \n    return {\n        "loss": loss,\n        "accuracy": eval_results["accuracy"],\n        "diagnostics": eval_results["diagnostic_results"]\n    }\n\n# Training loop\nwith wandb.init(project=project, config={"lr": 0.01}) as run:\n    for epoch in range(5):\n        # Execute training with Weave tracing\n        results = training_step(epoch, run.config.lr)\n        \n        # Log to W&B - creates the integration point\n        run.log({\n            "epoch": epoch,\n            "loss": results["loss"],\n            "accuracy": results["accuracy"]\n        })\n'})}),"\n",(0,a.jsx)(n.p,{children:"You can run this example script to see how traces get logged with the rest of your run information."}),"\n",(0,a.jsxs)(n.p,{children:["To view the trace information in your workspace during or after a run, you can either open the link provided in the terminal at the start of a run (it looks like this: ",(0,a.jsx)(n.code,{children:"wandb: \ud83d\ude80 View run at https://wandb.ai/wandb/my-project/runs/<run-ID>"}),") or navigate to the workspace in the UI."]}),"\n",(0,a.jsx)(n.p,{children:"To navigate to a workspace from the UI:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Open the W&B UI and click the ",(0,a.jsx)(n.strong,{children:"Projects"})," tab. This opens a list of your projects."]}),"\n",(0,a.jsxs)(n.li,{children:["From the list of projects, click the project that you logged your run to. This opens the ",(0,a.jsx)(n.strong,{children:"Workspaces"})," page."]}),"\n",(0,a.jsxs)(n.li,{children:["If you've set up your workspace as an automatic workspace, the workspace automatically populates with data visualizations and information about your run. The trace data for your run is under the ",(0,a.jsx)(n.strong,{children:"Weave"})," section of the workspace. If your workspace is a manual workspace, you can add Weave panels to by clicking ",(0,a.jsx)(n.strong,{children:"Add panels"})," and selecting new panels from the ",(0,a.jsx)(n.strong,{children:"Weave"})," section of the Add Panels menu."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["For more information about workspaces, see ",(0,a.jsx)(n.a,{href:"https://docs.wandb.ai/guides/track/workspaces",children:"View experiments results"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},6139:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/traces-in-workspace-5de7d7c80a6fec495f3b94aad12a70e4.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>i,a:()=>r});var a=t(67294);const o={},s=a.createContext(o);function r(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);