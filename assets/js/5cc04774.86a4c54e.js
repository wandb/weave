"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3003],{92826:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var t=r(85893),s=r(11151);const a={title:"Scorers as Guardrails"},o="Scorers as Guardrails",i={id:"reference/gen_notebooks/scorers_as_guardrails",title:"Scorers as Guardrails",description:"Open in Colab",source:"@site/docs/reference/gen_notebooks/scorers_as_guardrails.md",sourceDirName:"reference/gen_notebooks",slug:"/reference/gen_notebooks/scorers_as_guardrails",permalink:"/reference/gen_notebooks/scorers_as_guardrails",draft:!1,unlisted:!1,editUrl:"https://github.com/wandb/weave/blob/master/docs/docs/reference/gen_notebooks/scorers_as_guardrails.md",tags:[],version:"current",lastUpdatedAt:1749652482e3,frontMatter:{title:"Scorers as Guardrails"},sidebar:"notebookSidebar",previous:{title:"Handling and Redacting PII",permalink:"/reference/gen_notebooks/pii"},next:{title:"Service API",permalink:"/reference/gen_notebooks/weave_via_service_api"}},l={},c=[];function p(e){const n={admonition:"admonition",code:"code",h1:"h1",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.admonition,{title:"This is a notebook",type:"tip",children:[(0,t.jsx)("a",{href:"https://colab.research.google.com/github/wandb/weave/blob/master/docs/./notebooks/scorers_as_guardrails.ipynb",target:"_blank",rel:"noopener noreferrer",class:"navbar__item navbar__link button button--secondary button--med margin-right--sm notebook-cta-button",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/archive/d/d0/20221103151430%21Google_Colaboratory_SVG_Logo.svg",alt:"Open In Colab",height:"20px"}),(0,t.jsx)("div",{children:"Open in Colab"})]})}),(0,t.jsx)("a",{href:"https://github.com/wandb/weave/blob/master/docs/./notebooks/scorers_as_guardrails.ipynb",target:"_blank",rel:"noopener noreferrer",class:"navbar__item navbar__link button button--secondary button--med margin-right--sm notebook-cta-button",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg",alt:"View in Github",height:"15px"}),(0,t.jsx)("div",{children:"View in Github"})]})})]}),"\n",(0,t.jsx)(n.h1,{id:"scorers-as-guardrails",children:"Scorers as Guardrails"}),"\n",(0,t.jsxs)(n.p,{children:["Weave Scorers are special classes with a ",(0,t.jsx)(n.code,{children:"score"})," method that can evaluate the performance of a call. They can range from quite simple rules to complex LLMs as judges."]}),"\n",(0,t.jsx)(n.p,{children:"In this notebook, we will explore how to use Scorers as guardrails to prevent your LLM from generating harmful or inappropriate content."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"%pip install weave --quiet\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'"""\nExample demonstrating how to implement guardrails in Weave.\nThis example shows a simple content safety checker that prevents\npotentially harmful or negative responses.\n"""\n\nimport weave\n\n# Initialize Weave with a descriptive project name\nweave.init("content-safety-guardrails")\n\n\nclass ContentSafetyScorer(weave.Scorer):\n    """A scorer that evaluates content safety based on presence of specified phrases."""\n\n    unsafe_phrases: list[str]\n    case_sensitive: bool = False\n\n    @weave.op\n    def score(self, output: str) -> bool:\n        """\n        Evaluate output safety based on presence of unsafe phrases.\n\n        Args:\n            output: The text output to evaluate\n\n        Returns:\n            bool: True if output is safe, False if unsafe\n        """\n        normalized_output = output if self.case_sensitive else output.lower()\n\n        for phrase in self.unsafe_phrases:\n            normalized_phrase = phrase if self.case_sensitive else phrase.lower()\n            if normalized_phrase in normalized_output:\n                return False\n        return True\n\n\n@weave.op\ndef generate_response(prompt: str) -> str:\n    """Simulate an LLM response generation."""\n    if "test" in prompt.lower():\n        return "I\'m sorry, I cannot process that request."\n    elif "help" in prompt.lower():\n        return "I\'d be happy to help you with that!"\n    else:\n        return "Here\'s what you requested: " + prompt\n\n\nasync def process_with_guardrail(prompt: str) -> str:\n    """\n    Process user input with content safety guardrail.\n    Returns the response if safe, or a fallback message if unsafe.\n    """\n    # Initialize safety scorer\n    safety_scorer = ContentSafetyScorer(\n        name="Content Safety Checker",\n        unsafe_phrases=["sorry", "cannot", "unable", "won\'t", "will not"],\n    )\n\n    # Generate response and get Call object\n    response, call = generate_response.call(prompt)\n\n    # Apply safety scoring\n    evaluation = await call.apply_scorer(safety_scorer)\n\n    # Return response or fallback based on safety check\n    if evaluation.result:\n        return response\n    else:\n        return "I cannot provide that response."\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'"""Example usage of the guardrail system."""\ntest_prompts = [\n    "Please help me with my homework",\n    "Can you run a test for me?",\n    "Tell me a joke",\n]\n\nprint("Testing content safety guardrails:\\n")\n\nfor prompt in test_prompts:\n    print(f"Input: \'{prompt}\'")\n    response = await process_with_guardrail(prompt)\n    print(f"Response: {response}\\n")\n'})})]})}function u(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},11151:(e,n,r)=>{r.d(n,{Z:()=>i,a:()=>o});var t=r(67294);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);